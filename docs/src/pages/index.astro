---
import Base from '../layouts/Base.astro';
---
<Base title="The Digital Oracle">
  <!-- Hero Section -->
  <section class="hero">
    <div class="hero-content">
      <img
        src={`${import.meta.env.BASE_URL}/images/logo/logo-v4-abstract-eye.svg`}
        alt="Priap.OS Logo"
        class="hero-logo"
      />
      <h1>PRIAP.OS</h1>
      <p class="hero-subtitle">
        AI experimentation framework for <a href="https://leekwars.com" target="_blank">LeekWars</a>
      </p>
      <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
        <a href="https://github.com/PLNech/Priap.OS" class="btn btn-primary">
          GitHub
        </a>
        <a href="#how" class="btn btn-secondary">
          How It Works
        </a>
      </div>
    </div>
  </section>

  <!-- STELLAR Methodology - Single Line with Hover Cards -->
  <section class="container" id="methodology">
    <div class="divider"><span>Methodology</span></div>

    <div class="stellar-row">
      <div class="stellar-letter" data-letter="S">
        <span class="letter">S</span>
        <span class="word">ystematic</span>
        <div class="stellar-popup">
          <div class="popup-example bad">
            <span class="label">Bad</span>
            <code>"Let's try random stuff"</code>
          </div>
          <div class="popup-example good">
            <span class="label">Good</span>
            <code>H007: If kite at 60% HP, win +5%</code>
          </div>
        </div>
      </div>
      <div class="stellar-letter" data-letter="T">
        <span class="letter">T</span>
        <span class="word">estable</span>
        <div class="stellar-popup">
          <div class="popup-example bad">
            <span class="label">Bad</span>
            <code>"This feels better"</code>
          </div>
          <div class="popup-example good">
            <span class="label">Good</span>
            <code>n=1000, p&lt;0.05, delta=3.5%</code>
          </div>
        </div>
      </div>
      <div class="stellar-letter" data-letter="E">
        <span class="letter">E</span>
        <span class="word">fficient</span>
        <div class="stellar-popup">
          <div class="popup-example bad">
            <span class="label">Bad</span>
            <code>Test online, lose rank</code>
          </div>
          <div class="popup-example good">
            <span class="label">Good</span>
            <code>1000 offline first, then 10 online</code>
          </div>
        </div>
      </div>
      <div class="stellar-letter" data-letter="L">
        <span class="letter">L</span>
        <span class="word">ogged</span>
        <div class="stellar-popup">
          <div class="popup-example bad">
            <span class="label">Bad</span>
            <code>"I think I tried this..."</code>
          </div>
          <div class="popup-example good">
            <span class="label">Good</span>
            <code>experiments.md: EXP-042</code>
          </div>
        </div>
      </div>
      <div class="stellar-letter" data-letter="L">
        <span class="letter">L</span>
        <span class="word">earning</span>
        <div class="stellar-popup">
          <div class="popup-example bad">
            <span class="label">Bad</span>
            <code>"It lost, next idea"</code>
          </div>
          <div class="popup-example good">
            <span class="label">Good</span>
            <code>Insight: retreat > react</code>
          </div>
        </div>
      </div>
      <div class="stellar-letter" data-letter="A">
        <span class="letter">A</span>
        <span class="word">daptive</span>
        <div class="stellar-popup">
          <div class="popup-example bad">
            <span class="label">Bad</span>
            <code>Same strat at all levels</code>
          </div>
          <div class="popup-example good">
            <span class="label">Good</span>
            <code>L10: rush, L20: kite, L50: combo</code>
          </div>
        </div>
      </div>
      <div class="stellar-letter" data-letter="R">
        <span class="letter">R</span>
        <span class="word">eproducible</span>
        <div class="stellar-popup">
          <div class="popup-example bad">
            <span class="label">Bad</span>
            <code>"Worked once, ship it"</code>
          </div>
          <div class="popup-example good">
            <span class="label">Good</span>
            <code>seed=42, same result 100%</code>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- How It Works -->
  <section class="container-narrow" id="how">
    <div class="divider"><span>How It Works</span></div>

    <div class="approach-grid">
      <div class="approach-card card">
        <h3>üéÆ generator.jar</h3>
        <p>LeekWars' open-source fight simulator. Runs battles locally at 20+ fights/second.</p>
        <code>java -jar generator.jar fight.json</code>
      </div>
      <div class="approach-card card">
        <h3>üêç simulator.py</h3>
        <p>Python wrapper with Py4J bridge. Orchestrates batch runs and parses results.</p>
        <code>sim.run_1v1(ai_a, ai_b, n=1000)</code>
      </div>
      <div class="approach-card card">
        <h3>üëÅÔ∏è Visibility Patches</h3>
        <p>Fork with exposed internals. Access fight state, entity positions, damage logs.</p>
        <code>result.raw_output["fight"]["dead"]</code>
      </div>
    </div>

    <div class="flywheel">
      <pre><code>Online ‚Üí Data ‚Üí Analyze ‚Üí Improve Offline ‚Üí Deploy</code></pre>
    </div>
  </section>

  <!-- Recent Discoveries -->
  <section class="container-narrow">
    <div class="divider"><span>Discoveries</span></div>

    <div class="discoveries-grid">
      <div class="discovery-card card">
        <div class="discovery-header">
          <span>Counter-Kiter</span>
          <span class="chip chip-success">+18%</span>
        </div>
        <code>if (dist > last_dist) commit_all_mp()</code>
      </div>
      <div class="discovery-card card">
        <div class="discovery-header">
          <span>Low-Damage Kiting</span>
          <span class="chip chip-error">-29%</span>
        </div>
        <code>// timeout instead of kills</code>
      </div>
      <div class="discovery-card card">
        <div class="discovery-header">
          <span>First-Mover</span>
          <span class="chip chip-info">~58%</span>
        </div>
        <code>// attacker advantage online</code>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <p>
        Built by <a href="https://me.nech.pl">PLN</a> ¬∑
        <a href="https://github.com/PLNech/Priap.OS">GitHub</a> ¬∑
        <a href="https://astro.build">Astro</a>
      </p>
    </div>
  </footer>

  <style>
    /* STELLAR Row */
    .stellar-row {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      flex-wrap: wrap;
      margin: 2rem 0;
    }

    .stellar-letter {
      position: relative;
      display: flex;
      align-items: baseline;
      padding: 0.5rem 0.75rem;
      background: var(--color-bg-elevated);
      border: 1px solid rgba(0, 245, 212, 0.2);
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .stellar-letter:hover {
      border-color: var(--color-cyan);
      box-shadow: var(--glow-cyan);
    }

    .stellar-letter .letter {
      font-family: var(--font-display);
      font-size: 1.5rem;
      font-weight: 700;
    }

    .stellar-letter:nth-child(1) .letter,
    .stellar-letter:nth-child(2) .letter,
    .stellar-letter:nth-child(3) .letter { color: var(--color-cyan); }
    .stellar-letter:nth-child(4) .letter,
    .stellar-letter:nth-child(5) .letter { color: var(--color-purple); }
    .stellar-letter:nth-child(6) .letter,
    .stellar-letter:nth-child(7) .letter { color: var(--color-leek); }

    .stellar-letter .word {
      font-size: 0.9rem;
      color: var(--color-text-dim);
    }

    /* Popup */
    .stellar-popup {
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%) translateY(-8px);
      background: var(--color-void);
      border: 1px solid var(--color-cyan);
      border-radius: 8px;
      padding: 1rem;
      min-width: 220px;
      opacity: 0;
      visibility: hidden;
      transition: all 0.2s ease;
      z-index: 100;
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 20px rgba(0,0,0,0.5);
    }

    .stellar-letter:hover .stellar-popup {
      opacity: 1;
      visibility: visible;
      transform: translateX(-50%) translateY(-12px);
    }

    .popup-example {
      margin-bottom: 0.75rem;
    }
    .popup-example:last-child { margin-bottom: 0; }

    .popup-example .label {
      display: block;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: 0.25rem;
    }

    .popup-example.bad .label { color: var(--color-coral); }
    .popup-example.good .label { color: var(--color-leek); }

    .popup-example code {
      display: block;
      font-size: 0.8rem;
      white-space: nowrap;
    }

    /* Approach Grid */
    .approach-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1rem;
      margin: 1.5rem 0;
    }

    .approach-card h3 {
      margin: 0 0 0.5rem;
      font-size: 1rem;
    }

    .approach-card p {
      font-size: 0.875rem;
      margin: 0 0 0.75rem;
      color: var(--color-text-dim);
    }

    .approach-card code {
      font-size: 0.75rem;
    }

    /* Flywheel */
    .flywheel {
      text-align: center;
      margin: 2rem 0;
    }

    .flywheel pre {
      display: inline-block;
      border-left: none;
      border: 2px solid var(--color-bronze);
      border-radius: 8px;
      padding: 1rem 2rem;
    }

    /* Discoveries Grid */
    .discoveries-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }

    .discovery-card {
      padding: 1rem;
    }

    .discovery-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
      font-weight: 600;
    }

    .discovery-card code {
      font-size: 0.75rem;
      display: block;
    }

    /* Footer tweak */
    footer p {
      margin: 0;
    }
  </style>
</Base>
